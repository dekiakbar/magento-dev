#!/usr/bin/env bash

function install()
{
  docker-compose exec fpm bin/magento setup:install \
  --base-url=http://magento2.docker/ \
  --db-host=db.magento2.docker \
  --db-name=magento2 \
  --db-user=magento2 \
  --db-password=magento2 \
  --admin-firstname=admin \
  --admin-lastname=admin \
  --admin-email=admin@admin.com \
  --admin-user=admin \
  --admin-password=admin123 \
  --language=en_US \
  --currency=USD \
  --timezone=America/Chicago \
  --use-rewrites=1 \
  --search-engine=elasticsearch7 \
  --elasticsearch-host=elasticsearch.magento2.docker \
  --elasticsearch-port=9200 \
  --elasticsearch-index-prefix=magento2 \
  --elasticsearch-timeout=15
}

function dev_mode()
{
  docker-compose exec fpm fpm  bin/magento deploy:mode:set developer --skip-compilation
  docker-compose exec fpm  bin/magento config:set web/cookie/cookie_lifetime 31536000
  docker-compose exec fpm  bin/magento config:set admin/security/session_lifetime 31536000
  docker-compose exec fpm  bin/magento config:set admin/security/use_form_key 0
  docker-compose exec fpm  bin/magento config:set dev/template/allow_symlink 1
  docker-compose exec fpm  bin/magento config:set dev/static/sign 0
  docker-compose exec fpm  bin/magento module:disable Magento_TwoFactorAuth
}

clear_compiled_code ()
{
  docker-compose exec fpm rm -rf generated/*
}

function clear_static()
{
  docker-compose exec fpm rm -rf var/cache/*
  docker-compose exec fpm rm -rf var/page_cache/*
  docker-compose exec fpm rm -rf var/view_preprocessed/*
  docker-compose exec fpm rm -rf pub/static/*
}

function clear_cache()
{
  docker-compose exec fpm bin/magento cache:flush
  docker-compose exec fpm bin/magento cache:clean
}

recompile_all ()
{
  docker-compose exec fpm bin/magento setup:upgrade
  docker-compose exec fpm bin/magento setup:di:compile
  docker-compose exec fpm bin/magento setup:static-content:deploy -f
}

rebuild_container()
{
  docker-compose up --build --force-recreate --no-deps --remove-orphans -d
}

